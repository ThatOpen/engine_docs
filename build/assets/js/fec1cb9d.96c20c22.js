"use strict";(self.webpackChunkengine_docs=self.webpackChunkengine_docs||[]).push([[7816],{9043:(e,t,n)=>{n.r(t),n.d(t,{assets:()=>l,contentTitle:()=>r,default:()=>h,frontMatter:()=>i,metadata:()=>s,toc:()=>d});var a=n(4848),o=n(8453);const i={},r=void 0,s={id:"Tutorials/UserInterface/Core/Table/LoadFunction",title:"LoadFunction",description:'window.open("https://thatopen.github.io/engine_ui-components/examples/Table/LoadFunction")} >Go Full Screen',source:"@site/docs/Tutorials/UserInterface/Core/Table/LoadFunction.mdx",sourceDirName:"Tutorials/UserInterface/Core/Table",slug:"/Tutorials/UserInterface/Core/Table/LoadFunction",permalink:"/Tutorials/UserInterface/Core/Table/LoadFunction",draft:!1,unlisted:!1,tags:[],version:"current",frontMatter:{},sidebar:"tutorialSidebar",previous:{title:"ExportingData",permalink:"/Tutorials/UserInterface/Core/Table/ExportingData"},next:{title:"Searching",permalink:"/Tutorials/UserInterface/Core/Table/Searching"}},l={},d=[{value:"Asynchronously Loading Data \ud83c\udf10",id:"asynchronously-loading-data-",level:3},{value:"\ud83d\udd96 Initializing the Library and Setting the Table",id:"-initializing-the-library-and-setting-the-table",level:3},{value:"\ud83d\udd04 The Load Function",id:"-the-load-function",level:3},{value:"\u274c Displaying Loading Errors",id:"-displaying-loading-errors",level:3},{value:"\ud83d\udd17 Putting Everything Together",id:"-putting-everything-together",level:3}];function c(e){const t={a:"a",admonition:"admonition",code:"code",h3:"h3",hr:"hr",p:"p",pre:"pre",...(0,o.R)(),...e.components};return(0,a.jsxs)(a.Fragment,{children:[(0,a.jsxs)("div",{style:{position:"relative"},children:[(0,a.jsx)("iframe",{src:"https://thatopen.github.io/engine_ui-components/examples/Table/LoadFunction"}),(0,a.jsx)("button",{class:"full-screen-btn",onClick:()=>window.open("https://thatopen.github.io/engine_ui-components/examples/Table/LoadFunction"),children:"Go Full Screen"})]}),"\n",(0,a.jsx)(t.admonition,{title:"Source",type:"info",children:(0,a.jsxs)(t.p,{children:["Copying and pasting? We've got you covered! You can find the full source code of this tutorial ",(0,a.jsx)(t.a,{href:"https://github.com/ThatOpen/engine_ui-components/blob/main/packages/core/src/components/Table/examples/LoadFunction/example.ts",children:"here"}),"."]})}),"\n",(0,a.jsx)(t.h3,{id:"asynchronously-loading-data-",children:"Asynchronously Loading Data \ud83c\udf10"}),"\n",(0,a.jsx)(t.hr,{}),"\n",(0,a.jsx)(t.p,{children:"Manually setting data in a bim-table may be ok in some situations. However, there are cases where the data must be fetch from an external resource, or you need to do some heavy processing to compute the data and want to display a loading skeleton to inform users about an on-going computation. You should be happy as we got you covered! All of that is possible in the bim-table component and you will learn how in this tutorial."}),"\n",(0,a.jsx)(t.h3,{id:"-initializing-the-library-and-setting-the-table",children:"\ud83d\udd96 Initializing the Library and Setting the Table"}),"\n",(0,a.jsx)(t.hr,{}),"\n",(0,a.jsx)(t.p,{children:"As always, let's first initialize the UI library. Remember you only have to do it once in your entire app."}),"\n",(0,a.jsx)(t.pre,{children:(0,a.jsx)(t.code,{className:"language-js",children:'// You have to import from "@thatopen/ui"\nimport * as BUI from "../../../..";\n\nBUI.Manager.init();\n'})}),"\n",(0,a.jsx)(t.p,{children:"After the library has been initialized, create a table or get an existing one from the HTML document. In this case, let's create one programatically:"}),"\n",(0,a.jsx)(t.pre,{children:(0,a.jsx)(t.code,{className:"language-js",children:'const table = document.createElement("bim-table");\n'})}),"\n",(0,a.jsx)(t.p,{children:"When you load data asynchronously, is very likely you do it on demand. That means, by default the table won't have any data. You can inform end-users about an empty table using a slot. For it, let's create the corresponding element as follows:"}),"\n",(0,a.jsx)(t.pre,{children:(0,a.jsx)(t.code,{className:"language-js",children:'const missingDataElement = BUI.Component.create(\n  () => BUI.html`\n    \x3c!-- The most important thing is to have the slot attribute set as missing-data --\x3e\n    \x3c!-- Other than that, the element can hold anything inside --\x3e\n    \x3c!-- Be aware you can use this missing-data slot no matter if you are not loading data asynchronously --\x3e\n    <div slot="missing-data"\n      style="display: flex; flex-direction: column; align-items: center; width: 8rem; margin: auto;">\n      <bim-label>No data loaded!</bim-label>\n      <bim-button @click=${() => table.loadData()} label="Load Data" style="width: 100%;"></bim-button>\n    </div>\n  `,\n);\n\ntable.append(missingDataElement);\n'})}),"\n",(0,a.jsxs)(t.p,{children:["Basically what happens is the table detects if the data property is empty. If it is, then the element with ",(0,a.jsx)(t.code,{children:'slot="missing-data"'})," will be displayed. The element can hold anything, and will be shown/hidden based on the data array. In this case, we added a handy button inside the missing data slot element the user can click to load data. As you see, the button triggers the loadData method in the table; which triggers the load function you have set in the table. We haven't set any load function yet, so let's do it now!"]}),"\n",(0,a.jsx)(t.h3,{id:"-the-load-function",children:"\ud83d\udd04 The Load Function"}),"\n",(0,a.jsx)(t.hr,{}),"\n",(0,a.jsx)(t.p,{children:"To load data asynchronously in the table, the only thing you need to do is provide a load function. The load function must be asynchronous and return the same structure of the table.data. You can do anything you want inside the function, as long it returns the corresponding data structure."}),"\n",(0,a.jsx)(t.admonition,{type:"tip",children:(0,a.jsx)(t.p,{children:"If you're unsure about the table data structure, check the main table tutorial to know everything about it!"})}),"\n",(0,a.jsx)(t.p,{children:"Inside the function you can also throw errors, and they will be catch by the bim-table component and displayed in the page. Let's define the function to see how it works:"}),"\n",(0,a.jsx)(t.pre,{children:(0,a.jsx)(t.code,{className:"language-js",children:'// Just to see how throwing errors work, let\'s define a checkbox to force one\nconst forceErrorCheckbox = BUI.Component.create<BUI.Checkbox>(\n  () => BUI.html`\n    <bim-checkbox label="Force Load Error" inverted></bim-checkbox>\n  `,\n);\n\n// As said, the loadFunction must be asyncrhonous.\n// If its not, then is pointless to use the loadFunction and instead directly set the table.data property.\ntable.loadFunction = async () => {\n  if (forceErrorCheckbox.checked)\n    // You can throw any errors as you like.\n    // The error message will be displayed inside the table but only if you have an error-loading slot.\n    // We will set one later in this tutorial!\n    throw new Error(\n      "You have forced an error and data couldn\'t be loaded! Try to disable the \'Force Load Error\' checkbox.",\n    );\n\n  const jsonData = await fetch(\n    "https://thatopen.github.io/engine_ui-components/resources/table-data.json",\n  );\n\n  if (!jsonData.ok) throw new Error("Failed fetching data from GitHub!");\n\n  // The function must return TableGroupData[]\n  // In this case we\'re sure the json data loaded has the corresponding structure\n  // If you\'re loading data from an external resource, then is your job to make sure\n  // it complains with the format.\n  const data = (await jsonData.json()) as BUI.TableGroupData[];\n  return data;\n};\n'})}),"\n",(0,a.jsx)(t.p,{children:"As you see, we're getting some data from GitHub. Fetching data is always an async operation, so its a perfect use case for the loadFunction!"}),"\n",(0,a.jsx)(t.h3,{id:"-displaying-loading-errors",children:"\u274c Displaying Loading Errors"}),"\n",(0,a.jsx)(t.hr,{}),"\n",(0,a.jsx)(t.p,{children:"In the function implementation we did before, we throw two errors: one we force, and the second in case fetching the data from GitHub returns a response other than 200. You can display error messages to the user, but only if you setup the corresponding error-loading as follows:"}),"\n",(0,a.jsx)(t.pre,{children:(0,a.jsx)(t.code,{className:"language-js",children:'const loadingErrorElement = BUI.Component.create(\n  () => BUI.html`\n    \x3c!-- Just as it happens with the missing-data slot, here the important thing is to have the slot attribute set as error-loading --\x3e\n    <div slot="error-loading"\n      style="display: flex; flex-direction: column; align-items: center; width: 8rem; margin: auto;">\n      \x3c!-- To specify the table where it needs to display the message thrown by the error, you need to include data-table-element=\'error-message\' in any element inside the error-loading slot --\x3e\n      <bim-label data-table-element=\'error-message\'>Data failed to load!</bim-label>\n      <bim-button @click=${() => table.loadData()} label="Try Again" style="width: 100%;"></bim-button>\n    </div>\n  `,\n);\n\ntable.append(loadingErrorElement);\n'})}),"\n",(0,a.jsxs)(t.p,{children:["By default, when you trigger loadData in the table, it does nothing in case the table already contains values. You have two options if you want to load the data back again: to clean table.data or to write ",(0,a.jsx)(t.code,{children:"table.load(true)"}),". In this case, let's create a simple button to clean the data property so you can play around and force an error with the checkbox we did before:"]}),"\n",(0,a.jsx)(t.pre,{children:(0,a.jsx)(t.code,{className:"language-js",children:'const cleanDataBtn = BUI.Component.create(\n  () =>\n    BUI.html`\n    <bim-button @click=${() => (table.data = [])} label="Clean Data"></bim-button>\n  `,\n);\n'})}),"\n",(0,a.jsx)(t.h3,{id:"-putting-everything-together",children:"\ud83d\udd17 Putting Everything Together"}),"\n",(0,a.jsx)(t.hr,{}),"\n",(0,a.jsx)(t.p,{children:"As everything is already setup, let's create a new component to hold all components together and display them in the page. You can do it very easily as follows:"}),"\n",(0,a.jsx)(t.pre,{children:(0,a.jsx)(t.code,{className:"language-js",children:'const appContent = BUI.Component.create(\n  () => BUI.html`\n    <div style="display: flex; flex-direction: column; gap: 0.75rem; height: 100%;">\n      <div style="display: flex; gap: 0.375rem; width: 10rem;">\n        ${forceErrorCheckbox}\n        ${cleanDataBtn}\n      </div>\n      ${table}\n    </div>\n  `,\n);\n\ndocument.body.append(appContent);\n'})}),"\n",(0,a.jsx)(t.p,{children:"Great! As you see, setting up async loading and handling errors is extremely simple when you use the bim-table component from That Open Engine. Let's continue with more tutorials! \ud83d\ude80"})]})}function h(e={}){const{wrapper:t}={...(0,o.R)(),...e.components};return t?(0,a.jsx)(t,{...e,children:(0,a.jsx)(c,{...e})}):c(e)}},8453:(e,t,n)=>{n.d(t,{R:()=>r,x:()=>s});var a=n(6540);const o={},i=a.createContext(o);function r(e){const t=a.useContext(i);return a.useMemo((function(){return"function"==typeof e?e(t):{...t,...e}}),[t,e])}function s(e){let t;return t=e.disableParentContext?"function"==typeof e.components?e.components(o):e.components||o:r(e.components),a.createElement(i.Provider,{value:t},e.children)}}}]);