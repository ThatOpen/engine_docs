"use strict";(self.webpackChunkengine_docs=self.webpackChunkengine_docs||[]).push([[8939],{1216:(e,n,t)=>{t.r(n),t.d(n,{assets:()=>l,contentTitle:()=>i,default:()=>h,frontMatter:()=>s,metadata:()=>a,toc:()=>c});var o=t(4848),r=t(8453);const s={},i=void 0,a={id:"Tutorials/UserInterface/OBC/RelationsTree",title:"RelationsTree",description:'window.open("https://thatopen.github.io/engine_ui-components/examples/RelationsTree")} >Go Full Screen',source:"@site/docs/Tutorials/UserInterface/OBC/RelationsTree.mdx",sourceDirName:"Tutorials/UserInterface/OBC",slug:"/Tutorials/UserInterface/OBC/RelationsTree",permalink:"/Tutorials/UserInterface/OBC/RelationsTree",draft:!1,unlisted:!1,tags:[],version:"current",frontMatter:{},sidebar:"tutorialSidebar",previous:{title:"ModelsList",permalink:"/Tutorials/UserInterface/OBC/ModelsList"},next:{title:"TopicsUI",permalink:"/Tutorials/UserInterface/OBC/TopicsUI"}},l={},c=[{value:"Showing your model tree \ud83c\udf32",id:"showing-your-model-tree-",level:2},{value:"\ud83d\udd96 Importing our Libraries",id:"-importing-our-libraries",level:3},{value:"\ud83d\udccb Initializing the UI",id:"-initializing-the-ui",level:3},{value:"\ud83c\udf0e Setting up a simple scene",id:"-setting-up-a-simple-scene",level:3},{value:"Setting up the components",id:"setting-up-the-components",level:3},{value:"Creating the tree",id:"creating-the-tree",level:3}];function d(e){const n={a:"a",admonition:"admonition",code:"code",h2:"h2",h3:"h3",hr:"hr",li:"li",p:"p",pre:"pre",ul:"ul",...(0,r.R)(),...e.components};return(0,o.jsxs)(o.Fragment,{children:[(0,o.jsxs)("div",{style:{position:"relative"},children:[(0,o.jsx)("iframe",{src:"https://thatopen.github.io/engine_ui-components/examples/RelationsTree"}),(0,o.jsx)("button",{class:"full-screen-btn",onClick:()=>window.open("https://thatopen.github.io/engine_ui-components/examples/RelationsTree"),children:"Go Full Screen"})]}),"\n",(0,o.jsx)(n.admonition,{title:"Source",type:"info",children:(0,o.jsxs)(n.p,{children:["Copying and pasting? We've got you covered! You can find the full source code of this tutorial ",(0,o.jsx)(n.a,{href:"https://github.com/ThatOpen/engine_ui-components/blob/main/packages/obc/src/components/tables/RelationsTree/example.ts",children:"here"}),"."]})}),"\n",(0,o.jsx)(n.h2,{id:"showing-your-model-tree-",children:"Showing your model tree \ud83c\udf32"}),"\n",(0,o.jsx)(n.hr,{}),"\n",(0,o.jsx)(n.p,{children:"Among the most common things to do with BIM models, is to show their spatial structure. This is really important, because then you can know better the model and see how elements are hierarchized between them. \ud83d\udd17\nHowever, the IFC schema is not always that intuitive when it comes to create a model tree. Why? You may wonder... and it's because IfcRelContainedInSpatialStructure is not the only IFC relation that takes play in a real model tree. \ud83e\udd2f Luckily, this is already taken into account by That Open Engine's UI when creating a model tree. Let's learn how you can use the Relations Tree!"}),"\n",(0,o.jsx)(n.h3,{id:"-importing-our-libraries",children:"\ud83d\udd96 Importing our Libraries"}),"\n",(0,o.jsx)(n.p,{children:"In this tutorial, we will import:"}),"\n",(0,o.jsxs)(n.ul,{children:["\n",(0,o.jsx)(n.li,{children:"@thatopen/components to set up the barebone of our app."}),"\n",(0,o.jsx)(n.li,{children:"@thatopen/components-front to use some frontend-oriented components."}),"\n",(0,o.jsx)(n.li,{children:"@thatopen/ui to add some simple and cool UI menus."}),"\n",(0,o.jsx)(n.li,{children:"@thatopen/ui-obc to add some cool pre-made UI menus for components."}),"\n"]}),"\n",(0,o.jsx)(n.pre,{children:(0,o.jsx)(n.code,{className:"language-js",children:'import * as OBC from "@thatopen/components";\nimport * as OBCF from "@thatopen/components-front";\nimport * as BUI from "@thatopen/ui";\n// You have to import from "@thatopen/ui-obc"\nimport * as BUIC from "../..";\n'})}),"\n",(0,o.jsx)(n.h3,{id:"-initializing-the-ui",children:"\ud83d\udccb Initializing the UI"}),"\n",(0,o.jsx)(n.p,{children:"As always, let's first initialize the UI library. Remember you only have to do it once in your entire app."}),"\n",(0,o.jsx)(n.pre,{children:(0,o.jsx)(n.code,{className:"language-js",children:"BUI.Manager.init();\n"})}),"\n",(0,o.jsx)(n.h3,{id:"-setting-up-a-simple-scene",children:"\ud83c\udf0e Setting up a simple scene"}),"\n",(0,o.jsx)(n.hr,{}),"\n",(0,o.jsx)(n.p,{children:"We will start by creating a simple scene with a camera and a renderer. If you don't know how to set up a scene, you can check the Worlds tutorial."}),"\n",(0,o.jsx)(n.pre,{children:(0,o.jsx)(n.code,{className:"language-js",children:'const components = new OBC.Components();\n\nconst worlds = components.get(OBC.Worlds);\nconst world = worlds.create();\n\nconst sceneComponent = new OBC.SimpleScene(components);\nsceneComponent.setup();\nworld.scene = sceneComponent;\n\nconst viewport = document.createElement("bim-viewport");\nconst rendererComponent = new OBC.SimpleRenderer(components, viewport);\nworld.renderer = rendererComponent;\n\nconst cameraComponent = new OBC.SimpleCamera(components);\nworld.camera = cameraComponent;\n\nviewport.addEventListener("resize", () => {\n  rendererComponent.resize();\n  cameraComponent.updateAspect();\n});\n\nconst viewerGrids = components.get(OBC.Grids);\nviewerGrids.create(world);\n\ncomponents.init();\n'})}),"\n",(0,o.jsx)(n.h3,{id:"setting-up-the-components",children:"Setting up the components"}),"\n",(0,o.jsxs)(n.p,{children:["First of all, we're going to get the ",(0,o.jsx)(n.code,{children:"FragmentIfcLoader"})," from an existing components instance:"]}),"\n",(0,o.jsx)(n.pre,{children:(0,o.jsx)(n.code,{className:"language-js",children:"const ifcLoader = components.get(OBC.IfcLoader);\nawait ifcLoader.setup();\n"})}),"\n",(0,o.jsx)(n.p,{children:"###\ud83d\udca1 Getting the highlighter\nNow, we will basically get the highlighter and set it up. This will create and configure 2 things:"}),"\n",(0,o.jsxs)(n.ul,{children:["\n",(0,o.jsx)(n.li,{children:"Selecting: when clicking on an element."}),"\n",(0,o.jsx)(n.li,{children:"Hovering: when hovering the mouse over an element."}),"\n"]}),"\n",(0,o.jsx)(n.pre,{children:(0,o.jsx)(n.code,{className:"language-js",children:"const highlighter = components.get(OBCF.Highlighter);\nhighlighter.setup({ world });\nhighlighter.zoomToSelection = true;\n"})}),"\n",(0,o.jsxs)(n.p,{children:["The step above is super important as none of the existing functional components setup any tool, they just get it as they are! So, if we don't setup the ",(0,o.jsx)(n.code,{children:"FragmentIfcLoader"})," then the wasm path is not going to be defined and an error will arise \ud83e\udd13. Just after we have setup the loader, let's then configure the ",(0,o.jsx)(n.code,{children:"FragmentManager"})," so any time a model is loaded it gets added to some world scene created before:"]}),"\n",(0,o.jsx)(n.pre,{children:(0,o.jsx)(n.code,{className:"language-js",children:"const fragmentsManager = components.get(OBC.FragmentsManager);\nfragmentsManager.onFragmentsLoaded.add(async (model) => {\n  if (world.scene) world.scene.three.add(model);\n});\n"})}),"\n",(0,o.jsx)(n.h3,{id:"creating-the-tree",children:"Creating the tree"}),"\n",(0,o.jsx)(n.p,{children:"Before using the Relations Tree, you must have the relations of your model indexed. This will ensure the Relations Tree have access to the required information to create the tree. \ud83c\udf32"}),"\n",(0,o.jsx)(n.pre,{children:(0,o.jsx)(n.code,{className:"language-js",children:"const indexer = components.get(OBC.IfcRelationsIndexer);\n\nfragmentsManager.onFragmentsLoaded.add(async (model) => {\n  if (model.hasProperties) await indexer.process(model);\n});\n"})}),"\n",(0,o.jsx)(n.admonition,{type:"tip",children:(0,o.jsxs)(n.p,{children:["If you're unsure about how the indexer works, you can take a look at the corresponding ",(0,o.jsx)(n.a,{href:"https://docs.thatopen.com/Tutorials/Components/Core/IfcRelationsIndexer",children:"IfcRelationsIndexer"})," tutorial!"]})}),"\n",(0,o.jsx)(n.p,{children:"Now the model has their relations indexed, we can safely create the corresponding tree. \ud83d\udcaa"}),"\n",(0,o.jsx)(n.pre,{children:(0,o.jsx)(n.code,{className:"language-js",children:"const [relationsTree] = BUIC.tables.relationsTree({\n  components,\n  models: [],\n});\n\nrelationsTree.preserveStructureOnFilter = true;\n"})}),"\n",(0,o.jsx)(n.p,{children:"As you see, we've passed an empty models list because in the first place there are no models. However, the Relations Tree updates it-self each time a new model comes into the scene! Which makes it really handy to work with.\nGreat! As we already created the Relations Tree instance, let's add it to the HTML page. For it, let's create simple BIM panel component where we include the tree and also a pre-made IFC load button \ud83d\udc47"}),"\n",(0,o.jsx)(n.pre,{children:(0,o.jsx)(n.code,{className:"language-js",children:'const panel = BUI.Component.create(() => {\n  const [loadIfcBtn] = BUIC.buttons.loadIfc({ components });\n\n  const onSearch = (e: Event) => {\n    const input = e.target as BUI.TextInput;\n    relationsTree.queryString = input.value;\n  };\n\n  return BUI.html`\n   <bim-panel label="Relations Tree">\n    <bim-panel-section label="Model Tree">\n      ${loadIfcBtn}\n      <bim-text-input @input=${onSearch} placeholder="Search..." debounce="200"></bim-text-input>\n      ${relationsTree}\n    </bim-panel-section>\n   </bim-panel> \n  `;\n});\n'})}),"\n",(0,o.jsx)(n.p,{children:"Finally, let's append the BIM Panel to the page to see the Relations Tree working \ud83d\ude09"}),"\n",(0,o.jsx)(n.pre,{children:(0,o.jsx)(n.code,{className:"language-js",children:'const app = document.getElementById("app") as BUI.Grid;\napp.layouts = {\n  main: {\n    template: `\n      "panel viewport"\n      / 30rem 1fr\n    `,\n    elements: { panel, viewport },\n  },\n};\n\napp.layout = "main";\n'})}),"\n",(0,o.jsx)(n.p,{children:"Congratulations! You've now a ready to go user interface that let's you show your model tree. \ud83e\udd73"})]})}function h(e={}){const{wrapper:n}={...(0,r.R)(),...e.components};return n?(0,o.jsx)(n,{...e,children:(0,o.jsx)(d,{...e})}):d(e)}},8453:(e,n,t)=>{t.d(n,{R:()=>i,x:()=>a});var o=t(6540);const r={},s=o.createContext(r);function i(e){const n=o.useContext(s);return o.useMemo((function(){return"function"==typeof e?e(n):{...n,...e}}),[n,e])}function a(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(r):e.components||r:i(e.components),o.createElement(s.Provider,{value:n},e.children)}}}]);